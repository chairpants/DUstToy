local Image1 = [[................................................................................
I...............................................................................
.......I..............III.................I..........I..............I...........
............I.....I..IIIII......................................................
....................IIIIIII.......I........................I................I...
...I................IIIIIII................................I....................
.....................IIIII................................I.I...................
..........I......I....III...............I.....I............I....................
...I.......................................................I....................
................................................................................
.................I.............I..................................I....I........
...........I..............I.....................................................
.......................................I........................................
.....I................I..............................I........................I.
..................................................................P.............
.............................................................PP..PP.............
.............PP...............................................PPP........I......
............P..PP...............P...........................PPPPTPP.............
.................P.P.P.....PPP.P.PP........................PP.PDDTPP............
...............PPTP.P.P....P.PPP...........................P.PPTD...............
..............P.TPT.........P.D.P..P.........................P...D..............
.............P...DP...........D.....P..P.........................D..............
................DD...........D....PP.PPP..P......P...............D..............
................D............D..P.PPPPPPPP...P..P..P..............D.............
................D.............D.PPSPPPPPPPPPPPPPPPP..P............D.............
.................D............DPPPPPSPPSPPSPPPPPPPPPPPP...........D.............
.................D............PPSSSSSSPSPSSSSSSSPPPPPP...........D..............
................D............PSPSSSSSSSSSSSSSSSSSSPPPP..........DD..............
.................D...........SOOSSSSSOSSSSOOSSSSSSSPPPP.........D...............
.................D.......SSSSOSSOSSSOSOSSOSSOSSSSSSSSSSSS.......D...............
..................D.....SSSSSSOSSSSSOSOSSSOOSSSSSSSSSSSSSS...S.DD...............
..................DD..SSSSSSOSSOSSSSOSOSSSSSOSSSSSSSSSSSSSOOSOOS................
...................D.SSSSSSSSOSOSSSSOSOSOOSSOSSSSSSSSSSSOODGGOOSS...............
WWWWWWWWWWWWWWWWWWWDSSSSSSSSSSOSSSSSSOSTTTOOSSSSSSSSSSSSOODDDDOOSSWWWWWWW.....W.
WWWWWWWWWWWWWWWWWSSSSSSSSSSSSSSSSSSSSTTTTTTTTTTSSSSSSSSSSOGGDGOSSSSWWSSWWWWWWWWW
WWWWWWWWWWWWWWWWSSSSSSSSSSSSSSSTTTTTTTTTTTTTTTTTTTTSSSSSSOOOOOSSSSSSSSSSSSWWWWWW
WWWWWWSSSWWSSSWSSSSSSSSSSSSTTTTTTTTTTTTTTTTTTTTTTTTTTSSSSSSSSSSSSSSSSSSSSSSWWWWW
WWWWWMTTTMMTTTSSSSSTTTTTTTTTTTTTTTTTMMMMMMMMTTTTTTTTTTTTTTTTSSSTTTTSSSSSSSSSSWWW
WWWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMDDDDDDDDMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWW
WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWTTTDDDDDDDDTTTWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW]]
local Image2 = [[WBPBWBO.SSOOSTTSOOSTOOIIIBGBMMBBBBWBWBWBBBBBBBBBGBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
BPBWBP.OOOOOOOIOISTOOGIIIGBMTTMBBWBWBPBBWBWBWBBBCOBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
PBPBWBOOTOOTTSOIOIOOIGIOGOMMTMMBWBWBWBBWBWBWBBBBCOBBBBBBBBWBPBPBBBBBBBBWWB.BBBBB
BWBWBOBTOO.TSOIIIIIIGIGGOGMMMMMBWBWBWBPBPBBBBBBBCOOBBBBBBWBWBPBWBBBBBBWBBWB.B.BB
WBWBPTTOOTTSOIIIIIIIGIGOGOGMMMBBBWBWBPBPBBBBBBBBCOOBBB.BBBWBWBWBWBWBWBBWWBWB..BB
BPBPOTTO.TSSIIIIIIIGIGMTOGSOBBBWWBPBPBPBBBBBBBBBCIOOBBBBBWBWBPBWBWBWBWBBBWBB.BBB
WBWBOTOTTSSIOIIIIIGIGMMMMOTSOBWBBWBWBPBPBBBBBWBWCIOOBBWBWBWBPBPBWBBBBBBBBBWBB.BB
BWBPOTOSSSOOIIIIIGIGIMMMMOOSOBBWWBWBPBPBBBWBWBWBCIIOOBWBBBBWBPBWBBBBBBBBBWBB.BBB
PBPBOTOSOOOIOGIIIGGIGTMMSOOOOBWBBWBPBPBBBBBWBWBWCIIOOBBBIIPBWBWBPBBB.BBBBBBBB.BB
BPBPBSTST.TSIIIGIGIGMTOTOOOOOBBBBPBBPBBBBBWBWOOBCCIOBBOBIIBBBWBBBBBWB.BB...B.BBB
PBPBOTOTSOOIOIGIGIGMTTO..OOOO.BWPBPBBBBBBBBWBOOBCIIOBBOOIIBBBBIBBBWBWB.......BBB
BBBBOTOOOOTTIOIGGGMMMOO.OOSO.BWBWPBPBBBBBBIIBOOBCIOBBBOOIIBOBBIBBWBWBBOO.......B
BBBBOSOOTSOOTIOIOSMTMOO.OOTOBWBWPBBBBBBIBOOIBOOBCIOBBBOOIIBOBBIBWBWBWWOOOOO.OOOB
BBBBBOOTSOOSTTSOIOOMOOOOSTOBWWBPBBBBBBIIBOOIBOOBIIBBBBOOIIOOBIIWBWBWBWBWBOOOOBSB
BBSSBOOSOOSTSSOOOMMTMO.OSSBBBWWBBBBBBBIIBOOIBOBBI.BBIIOOIIOOBIIBWWWSSSSSSBWBSSSS
BSSSSBOOOSTSOOOOMTMTSOOSOBBBBBBBBBBBBBIIBOOIBOBBPBBBIIOOIIOOBIIWBWSSSSSSSSSSSSSS
SSSSSSBOSTSOOOOOSMOOSOOOOBBBBBBBBBBBBBIIBOOITOTBPBBTIIOOIIOOBIIWSSSSSSSSSSSSSSSS
SSSSSSSOOOOOOOOOTOOOSOSSSSBBBBBBBBBBBBIIBOOITOTTPTTTIIOOITOOBIISSSSSSSSSSSSSSSSS
SSSSSSSSSOOOOOOTSOOOSSSSSSSSSSSSSSBBBBIITOOTTOTTPTTTTITOTTOTTIISSSSSSSSSSSSSSSSS
SSSSSSSSSSSOOOOOOOOOSSSSSSSSSSSSSSSSBTITTOOTTOTTPTTTTTTOTTTTTITSSSSSSSSSSSSSSSSS
SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSTTTTTTOOTTTTMPMMMMMMMTTTTTTTTTSSSSSSSSSSSSSSS
SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSMMMMMMMMMMMMMM.PWWWWW.W.MMMMMTTTTSSMWWWWWMMMMMT
WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWSWWWWWWWWWWWWWWWWWWWWWWWWWWWWMMMMMMTMMMMMTTOTTT
WMMMMMMWWWWWDMMDMMMDDWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWMMMMMMTTTOTTTTOTTTTTOTTT
DTTTTTTMMWDDTMTMMMMMTDWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWMTOTOTTTTTTOTTTOTTTTOTTTT
TT..TTTTTDDTMTMTTTTTMDWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWMTMTTOTOOTOTOTOTOTOTTOTTT
..OO..TTTTMTMMTMMMMMTTMWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWMMWMOTTTTTT.....OOTOOTOTT
OOOOOO..TTTMMMTTMTTTTTTMWWWWWWWWWWWMMMMMDDWWWWWWWWWWWWWMMWMMTTTTT..OOGOGO.TTTTTT
SOSOOOOO.TTMTTTTOTTTMTTTMMMMMWWWWWWMTTTTTTMDWWWWWWWWWWWDWMMWMMTTT.O.OOGOOO.TTTTT
OSSOSOOO.TM.OTOTTOTTTMTTTTTTTMDDDDMTTTTTTTTTDWWWWWWWWWWDMMWMWWMT.O.O.GOGOOO.TTTT
SOSSOOOO......TTOTOTOTMTTTTTTTTTTTTTTTTTTTTTTMDDWWWWWWWMMMMMWMMT..O.OOOOOOOOOTTT
OSOSSSOOOOOOOO...TTTTOTMTTTTTTTTTTTTTTTTTTTTTTTTMDWWWWWWWWMMMMWM...O.OOOOOOOOTTT
OSSOSOSOSOOSOOOOO..T..TTOTT..O..TTTTT......MMMMMMTOWWWWWWWWWWMMTT.O.OOOOOOOOOTTT
OSOSOSOSOSOOSOOOOOOSOO.....OOOOO..O..OOOOOOMMMMMTOGOOWWWOOOOOOOOO.OOOOOOOOOOOTTT
OSSSOSOOSOSSSSOSSOSOSOO.OOOOOOOOOOOOOOOOOOOOOOGOGGOGOOOOOOOOOOOOOO...OOOOOOO.OOT
SOSOSSSSOSSSSOSOOSOSOSSOOOOOOOOOOOOOOOOOOOOOGGGGOOGOOOOOOOOOOOOOOOOOO.OOO...OOOO
OSSSOSOOSOOOOOOSSOSSOOOOOOOOOOOOOOOOOOOOOOOOOOGOGOOGGOOOOOOOOOOOOOOOOO...OOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO
OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO]]
local Image3 = [[..............PPDP.P.PPP..PPP.P..P.PPPPDPPP..P..PPP.............................
.............PDPPPPPPPPPPPPP.PPPPPPPPDP...PP.PPPDP..PP..........................
.............PPP.PP.PP.P.PDP.PPPP.P.PDPPPPP.PPP.DPPPPP...................II.....
...........P.P.DDPPPPPP.DPP.DPPPP.PDPPPPP.PPPP.PPPP.P...................IGGI....
...........P.PPPPDD.PPPPPPP.PPPPT..P.P.PPPPPP...P.PPPPP................IGGIII...
............PPPPPPPPP.P..TPPDPDD.T.P.DP.PPP.PPPPP.PP.P.................IGIIGI...
...........P.P..PDPPPTTT.P.PDDDSDTT.GD.TPPDDT.P.P.PPPPP.................IIGI....
............PPDPPP..D..TTTT..PDSDTT.G..TTDDDT.PPTPP..PPPP................II.....
.........P.P.PDP.P.P......TT..PDDTTGDSST.DD.TPT..TPPPPPPD.P......P..............
........P..PPP..P.D.......TTDDD.SGTTDSSTDDDTTT.....PPT..DPPPP....D..............
......P..PPPP.PP...........TDDSSDGTTDDSTDDDT..........PPP.P.PDDDP...............
...........................TDDSSDGGSSSDSDT.T.........P.P......P.................
............................TDSDSSDTTGDTT.T.....................................
............................TDDDDDDTDTDTST......................................
............................TSSSSDSDSTGTST......................................
............................TTSDDSSDSDSDST......................................
....GG.......................TDTDGDSDDDDGST.....................................
...G..G......................TDTDDDTDSTDGDT.....................................
..I....G.....................TTSDGSTDSTDTTT.....................................
.I.....G......................TGDDDTDDDGTT......................................
I.......G.....................TGDGDTDDSSTT......................................
........G.....................TTDGSDTDDST.......................................
........G.....................TDSTSDSSDDT.......................................
.........G....................DGTDDSTDSGT...........................OOOOOOOOOOOO
.........G....................TDTSDSDDSGD..........................O............
.........G....................TGTSTSTDDSD.........................BBBBBBBBBBBBBB
.........D....................TDGTSDSDDDD........................BIIIIIIBBGGGGGB
.........D...................TTDDSDSDGSDD.......................B.......BBGGGGGG
..........D..................TTSDGDSDSDGD.......................B.......BBGGGGGG
..........D..................TSTDSDSDSDGDD.....................BB.D..SSSBBGGGGGG
..........D..................TSTGDGDSDSDST............BBBBBBBBBBBBBBBBBBBBBBBBBB
..........D..................TDTGDGDTSDDGT...........IBBBBBBBBBBBBBBBBBBBBBBBBBB
...........D.................TDTGDDDTTDSGT...........GBB...BBBBBBBBBBBBPBBBBBBBB
...........D.................TDGTSDSTTDGDST....P.P...BB..O..BBBBBBBBBBBPBBBBBBBB
...........D.........P......TDSDGDSTTDSDSDT....P.P...O..GOG..BBBBBBBBBBPBBBBBBBB
...........D.........P....P.TDSDGDDDSSDGSDSTD.P..P..GG.OOGOO.GGGGGGGGGGPGPGGGPBB
............D....P.P..P...P.TSDGSDDDSDSGDSDTGDP..P...P..GOG..PP...P..P.P.P.P.P..
............D..P.P..PP.P.PTTSDDGDTTGDSDSDGDTDGP.P..P..P..O..PPP.P.P.PPPPP.PTTP.T
......WWW...DSPPPPPPPPPPPTTSDDSGTTTTDTDDSDGTSDGDPPPPPPPPTPTPPTPPTPPPPPPPTPPPPPPP
WWWWWWWWWWWSSSTPTTTTTTTTTTSDDSGTTTTTDTSDSDSGTSTTDTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT]]
local Image4 = [[
MwswswswswsMTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
MTTTTTTMTMTMTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
MTGGTTTMMMMMMMMMMMMMMMMMMDDTTTTTTTTTTTTTTMMMTTTTTTMMMMTTTTTTTMMMMMMMTTTTTTTTTTTT
MTTTGGDTTDPPP............DDMMMMTTTTMMMMMMssTT..MMDMDPDDDD..MMMDDDDDD.....MMTTTTTT
MMTTTTGGDDDP.............DD....MMMM.PPPPPDDD....PPPDDPP.PPPPPPPP.P......MTTTTTTT
MTMMTTTTTDPDDD..P.P.PP.P.DD......PPPP....P....PPP.....PPP........PP.PPP...MTTTTT
MTTTMMMTGDPMMDDPPPPPPPPPPDDDDD...P.......PP..PP...................PPP.PP..MTTTTT
TMMMMMMMMMMMMMMMMMMMMMMMMMMMTDDPPP........PPPP..MMMMMMMMMMMMMMMMMMMMMMPPP.MTTTTT
TTTTTTTTTTTTTssDMssMMDMMMTTTTMM............MMTTTTTTTTTTTTTTTTTTTTTTTTTTMP...MTTTT
TTTTTTTTTTMMDDDDDDDDDDDDTTTMM............MTTTTTTTTTTTTTTTTTTTTTTTTTTTTMPP..MTTTT
TTTTTMMMMM.DPP....D.....MTTM....MMMMMMMMMTTTTTTTTTTTTTTTTTTTTTTTTTTTTTMP...MTTTT
TTTMM.....DP......DD.....MTM....MTTTTTTTTsSTTTTTTTTTTTTTTTTTTMMMMTMTMTMPP...MTTTT
TMM......PD........D......MM....MTTDDDDDDsswsTTTwsssTTTTTTTTTTMMssTTTTPPPPPP....TTTTM
M.......DD.........DD.....DDD..MTTTDTTTMDDDDDDDDDDDTTT.PPPDDDDDDDDPPPPP...TTTTM.
M...PPPPD...........D..PPPGGG..MTTTDTTTMTGDP.....PPPPPPP..DD....DD......TTTTMT..
M..PPMMMMMMMMMMMMMMMMPPM..PDD..MTTDDTTTMTD.PPP..PP........D......D....TTTTMMT...
M..PMTTTTTwsTTTTTTTTTTTTTMMMPPMMTTDDTTTTMT...PPPP.........D......DMMMMMMMTTT....
M..PMTTTTTDDDDDDDDDDDDDDDDDDDDDTTDDTTTTMM.....P...MMMMMMMMMMMMMMMMTTTTTTTT......
M..PMTTTTTDTTTTTTTTTDwsDTTMTDTDDDDDTTTTTM.....PP.MMTTTTTTTTTTTTTTTTTTTTT.........
M..P.MMMMMDMMMMMMMMMMDDDTMTDTTTTTDTTTTTM......PPMTTTTTTTTTTTTTTTTT..............
M..PP.....PP..D..........MssDDDTTTDDMssTssT....PPGGTTT..........................
M...P......PPDD..........MDDGDTTTMDDDDDDDDDDDDDPMTGT............................
M...PP.......D.......DDD..MDDDTTM.............PPMGTT............................
M....PPP....DDMMMMMMMM.DDDMTTTMM..............P.MGTTTTTTTTTTTTTTT...............
M......PPPPDD.MTTTTTTTM..DDMTM..........OOO...P.MTTTTTTTTTTTTTTTTTTTTTTT........
M........P.D..MTTTTTTTM....MTMDDDG.....OOOO...PPMTTTTTTMMTTTMMMMMMMMMTTTTTTTT...
TMMMMMMMMDMMMMTTTTTTTTM..DDMTMDDGD.OO..OOOO....PPMTMMMMssTssTssTMMssTssTTTTTTTTTTTT..
TTTTTTTTMDMTTTTTTTTTTTM.DD.MTD.GDD.OOO.OOOO.....PPPPDDDPDDDDDDPDDDDDDDDDMMTTMTTT
TTTTTMMMMDMMMMMMMMMssMssTDDDPPPDDDDDDDDMMMMMMM.......DP......P.....PPD......TTMT
TTTTM....P.........DDDDD..PMMMwSD.DwSDDTTTM..........PD.............DP......MTTT
TTTM....GDP.GDD.....D.....PMTMWD.DWMDTTTMOO.........PDD.............DDPPP....MTT
TTM.....DGDPDGD.....D.....PMTMDPPPDTDTTTMOOO.OO......DD.............DD..PPP...MT
TTM.....DDGPDDG....DD....PPMTTM...MTDTTTMOOO.OO......DD.............DD....PP..MT
TTM...DGDPDDD.DDG..DD....P.MTM....MTDTT.TMMMMMMMM....DDP............DD.....P..MT
TTM...DGD.GGGPDGDP.D....PP.MTM....MTDTTTTTTTTTTTTM...DD.............DD....P.P.MT
TTM...DGD.DDD.GDDPPDPPP.P..MTM....MTDDDDDDTTTTTTTTMM.DD.............DD.....P..MT
TTTMMMMDMMM.MMMMMMMPPMPPP..MTM....MTTTTTTDTTDDDDDTTTMMD.............DD........MT
TTTTTTTDTTTMTTTTTTTTTTMMMMMTTM...MTTTTTTDDDDDTTTDTTTTTMMMMMMMMM.....DD....MMMMTT
TTTTTTTTTTTTTTTTTTTTTTTTTTTTTM...MTTTTTTTTTTTTTTDDDDDDGGGGGGGGGMMMMMMMMMMMTTTTTT
TTTTTTTTTTTTTTTTTTTTTTTTTTTTTT....TTTTTTTTTTTTTTTTTTDDDDDDDDDDGGGGGGGGTTTTTTTTTT]]
local Image5 = [[................................................................................
....IIIIII.......G..............................................................
...IIGIIIII..................G.........PPP..............................G.......
...IIIIIGIII...........................PBP................T.....................
..IIIIGGIGII...........................PPP........G......TDDDD..................
..IIIIIGIIII..................G........BBB..............TT.III.......G..........
..IIGIIGIGII........BPPP...............BBB.............TTD.III..................
..IGIIGIIIII........BPBP...............BBB.............TTDIIII..................
...IIIIGIII........BBPPP..........G....PPB............DITDII.................G..
....GIIIIII........BBBB................PPP......G.....DITDII...G.......G........
.....GIII.........BBBB.....G..........BBPP...........DIPPBBBBB..................
..................BBPPB........G......BBB............IIPPPBBBB..................
.............G...BBBPPP..............BBBB............IIBPDBBBBBBB...............
.................BBBBPP............PPPBBB............I..TD..BPBBBBBB............
................BBBB...............PBPBB............II..TD..PPPBBBBBB...........
...............BBBBB......PPB..BBB.PPPB....BPPP.....I...TD..PPP.PPPBB...........
....G.........BBPPB.......PPPBBBBBBB.......BPBPBBB..I...TD......PBPBBB..G.......
.............BBBPPP.......BPPBBBBBBBBB.....BPPPBBBBB....TD......PPPBBB..........
.............BBBBPP....G..BBBBBBBBBBPPB........BPPPBB...DT...G.....BBB........D.
.......G.....BBB...............BPPPBPPPBB.......PBPBB...TT.........PBP.......TD.
.............BBB.....BBBB......BBPP.BPPBB.G.....PPPBB...T..........PBP.......TD.
............BBPP.....BBBB.....BBBB....BBB..........BBB.............PPP......TTD.
..........BBBPPP.....BPPB.....BBB.......BBPP.......PPP....D........BBB......TDD.
..........BBBPPB.....PPP......BBB.......BPPP.......PBPB..D........PPPB.....TTDDC
..........BBB........PPB......BBC.......BPPBB......PPPB...........PBPB....TTTDOC
.........BBBB........BBB......BCBB........BBBB......BBB...D.D....BPPPB...TDTDODC
.........BBBPPB......BBBB...B.BBBBC.......BBBB.......BBB.........BBBB...TDTDODDC
.........BBBPPP.......CCB..BBCCBBBBC........BB.......BPP........PPPBB..TDTDODDOD
..........BBBPP......CCCCBBBCCCBBBBBB......CCCB......PBP.......BPBP...TDTDDDDODD
......WW..BBBBWWW..CCCBCCBCCBBBBBBBBBWWW.CCBCCBWWW...PPBBW...W.BPPPWWW.MMTTMMTTC
BBBWWBBBBWWWWWBBBBWWWBBBWWWWWBWBWBBWWWWWBWBBBBBBBBBBWWWWBBBBBBWBWWWBBBBW.BCWW.BB
BBBBBBBWBBBBBBBBWBBWBWBBBBBBBBBBBBBBBBWBBBBBBBWBBBWBBBBBWBBBWBBBBBBBBBBBBBBBBWWB
BBBBBBBBWWBBWBBWBBBBBBBBBWWBBWWWWBWWWBBBBBWWWBBBBBBWWBWBBBBWWWBBBWBBWWBWWBBWWBBB
BBBBBBmmmWmWWWWBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBWBB
BBBBBbbbbbbbbbbmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
BBBBBbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
BBBBBbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
BBBBBbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
bbbbbbbbbbbbbmmmbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF]]
local a=loadFont("Play",20)local b={"Pen","Paintbrush","Line","Circle","Rectangle"}function unpack(c,d)d=d or 1;if c[d]then return c[d],unpack(c,d+1)end end;local function e(f)setNextStrokeColor(f,0,0,0,1)setNextStrokeWidth(f,3)end;function atan2(g,h)return math.atan(g/h)end;local f=createLayer()local i=createLayer()local j=createLayer()local k=createLayer()local l,m=getResolution()local n=80;local o=40;local p=math.min(l/n,m/o)local q={None={color={0,0,0,0},char="."},Stone={color={0.3,0.3,0.3,1},char="O"},Water={color={0,0,1,1},char="W",direction=0},Fire={color={1,0,0,1},char="F",fuelCount=0},Sand={color={0.8,0.7,0.5,1},char="S"},BurningSand={color={0.9,0.6,0.3,1},char="BS",burnCount=0},Glass={color={0.7,0.9,1,1},char="GS"},Wood={color={0.4,0.3,0.1,1},char="D"},Plant={color={0,1,0,1},char="P"},Wsrc={color={0,0,1,0.8},char="ws"},Ssrc={color={0.8,0.7,0.5,0.8},char="sS"},burning_Wood={color={1,0.5,0,1},char="d",fuelCount=0},burning_Plant={color={1,0.5,0,1},char="p",fuelCount=0},Coal={color={0.2,0.2,0.2,1},char="C"},TNT={color={0.6,0.6,0.6,1},char="G",fuelCount=0},ignited_TNT={color={1,1,0,1},char="g",fuelCount=0},Ice={color={0.7,.8,.96,1},char="I"},Dirt={color={0.37,0.26,0.15,1},char="T"},Mud={color={0.19,0.14,0.08,1},char="M"},Plastic={color={0.4,0.0,0.98,1},char="B"},burning_Plastic={color={0.47,0.13,0.95,1},char="b",burnCount=0},MoltenPlastic={color={0.55,0.2,1,1},char="m",coolingCount=0}}local r={"None","Stone","Water","Wsrc","Ice","Fire","Sand","Ssrc","Dirt","Wood","Plant","TNT","Plastic"}charToElement={["W"]=q.Water,["D"]=q.Burning_Wood,["P"]=q.Plant,["b"]=q.burning_Plastic,["O"]=q.Stone,["S"]=q.Sand,["ws"]=q.Wsrc,["sS"]=q.Ssrc,["GS"]=q.Glass,["T"]=q.Dirt,["C"]=q.Coal,["I"]=q.Ice,["G"]=q.TNT,["M"]=q.Mud,["B"]=q.Plastic,["."]=q.None}if not init then bgColor={r=0,g=0,b=0}flowDirection={}savedState=nil;startX,startY=nil,nil;copiedArea=nil;isSaving=false;isLoading=false;saveMessageTime=0;loadMessageTime=0;isUndoing=false;isRedoing=false;chatSaving=false;chatLoading=false;copyStartX,copyStartY=nil,nil;init=true;debug=false;selectedTab="Tools"selectedTool="Pen"selectedElement=q.Water;undoStack={}redoStack={}maxUndoSteps=25;lastTime=getTime()fireSpreadCounter={}fireSpreadDelay=5;fireSpreadChance=0.3;maxFireSpreadRadius=3;tntIgniteCounter={}tntBlastRange=3;tntIgniteCounter={}TNTDetonationLimit=50;TNTDetonationCount=0;TNTCooldown=0.5;TNTLastDetonationTime=nil;fillMode=false;paintbucket=false;grid={}for g=1,o do grid[g]={}for h=1,n do grid[g][h]=q.None;fireSpreadCounter[g*n+h]=0 end end end;local function s(f,h,g)if h==-1 then return end;local t=15;local u=t/2;local v=1;local function w()setNextShadow(f,5,0,0,0,1)setNextStrokeColor(f,1,1,1,1)setNextStrokeWidth(f,v)end;w()addLine(f,h-u,g-u,h-u+5,g-u)w()addLine(f,h-u,g-u,h-u,g-u+5)w()addLine(f,h+u,g-u,h+u-5,g-u)w()addLine(f,h+u,g-u,h+u,g-u+5)w()addLine(f,h-u,g+u,h-u+5,g+u)w()addLine(f,h-u,g+u,h-u,g+u-5)w()addLine(f,h+u,g+u,h+u-5,g+u)w()addLine(f,h+u,g+u,h+u,g+u-5)end;function drawRCostBar(f)local x=getRenderCost()local y=getRenderCostMax()local z=6;local A=m;local B=l-z;local C=m-A;setNextFillColor(f,0.2,0.2,0.2,1)addBox(f,B,C,z,A)local D=x/y*A;setNextFillColor(f,0.0,0.8,0.0,1)addBox(f,B,C+A-D,z,D)end;function drawGrid()for g=1,o do for h=1,n do local E=grid[g][h]if E.char=="."then setNextFillColor(f,bgColor.r,bgColor.g,bgColor.b,1)else setNextFillColor(f,unpack(E.color))end;addBox(f,(h-1)*p,(g-1)*p,p,p)end end end;function saveState()savedState={}for g=1,o do savedState[g]={}for h=1,n do savedState[g][h]=grid[g][h]end end;isSaving=false end;function loadState()if savedState then for g=1,o do for h=1,n do grid[g][h]=savedState[g][h]end end end;isLoading=false end;local function F()for g=1,o do grid[g]={}for h=1,n do grid[g][h]=q.None;fireSpreadCounter[g*n+h]=0 end end;isResetting=false end;local function G()local H={}for g=1,o do H[g]={}for h=1,n do H[g][h]=grid[g][h]end end;table.insert(undoStack,H)if#undoStack>maxUndoSteps then table.remove(undoStack,1)end;redoStack={}isSaving=false end;local function I()if#undoStack>0 then local H=table.remove(undoStack)table.insert(redoStack,grid)grid=H end end;isUndoing=false;local function J()if#redoStack>0 then local H=table.remove(redoStack)table.insert(undoStack,grid)grid=H end;isRedoing=false end;function drawLine(K,L,M,N,E)local O=math.abs(M-K)local P=math.abs(N-L)local Q=K<M and 1 or-1;local R=L<N and 1 or-1;local S=O-P;while true do local T=math.floor(K/p)+1;local U=math.floor(L/p)+1;if T>=1 and T<=n and U>=1 and U<=o then grid[U][T]=E end;if K==M and L==N then break end;local V=2*S;if V>-P then S=S-P;K=K+Q end;if V<O then S=S+O;L=L+R end end end;function plotRectanglePoints(K,L,M,N,E)local W,X=math.min(K,M),math.max(K,M)local Y,Z=math.min(L,N),math.max(L,N)for g=Y,Z do for h=W,X do if fillMode or g==Y or g==Z or h==W or h==X then if grid[g]and grid[g][h]then grid[g][h]=E end end end end end;function plotCirclePoints(_,a0,h,g,E,fillMode)local a1={{_+h,a0+g},{_-h,a0+g},{_+h,a0-g},{_-h,a0-g},{_+g,a0+h},{_-g,a0+h},{_+g,a0-h},{_-g,a0-h}}for a2,a3 in ipairs(a1)do local T=math.floor(a3[1]/p)+1;local U=math.floor(a3[2]/p)+1;if T>=1 and T<=n and U>=1 and U<=o then grid[U][T]=E end end end;function drawFilledCircle(_,a0,a4,E)local W=math.max(math.floor((_-a4)/p)+1,1)local X=math.min(math.floor((_+a4)/p)+1,n)local Y=math.max(math.floor((a0-a4)/p)+1,1)local Z=math.min(math.floor((a0+a4)/p)+1,o)for U=Y,Z do for T=W,X do local a5=(T-1)*p+p/2;local a6=(U-1)*p+p/2;if(a5-_)^2+(a6-a0)^2<=a4^2 then grid[U][T]=E end end end end;function drawRectangle(M,N,a7,a8,f)local a9=math.floor(M/p)+1;local aa=math.floor(N/p)+1;local ab=math.floor(a7/p)+1;local ac=math.floor(a8/p)+1;plotRectanglePoints(a9,aa,ab,ac,selectedElement)end;function drawCircle(_,a0,a4,f)if fillMode and a4>20 then end;if fillMode then drawFilledCircle(_,a0,a4,selectedElement)else local h=a4;local g=0;local ad=1-h;while g<=h do plotCirclePoints(_,a0,h,g,selectedElement,fillMode)plotCirclePoints(_,a0,g,h,selectedElement,fillMode)g=g+1;if ad<=0 then ad=ad+2*g+1 else h=h-1;ad=ad+2*(g-h)+1 end end end end;function drawPreview()local ae,af=getCursor()if ae>0 and af>0 then if selectedTool=="Line"and firstClick then setNextStrokeColor(i,1,1,1,1)setNextStrokeWidth(i,1)addLine(i,startX,startY,ae,af)elseif selectedTool=="Circle"and firstClick then local a4=math.sqrt((ae-startX)^2+(af-startY)^2)setNextStrokeColor(i,1,1,1,1)setNextStrokeWidth(i,1)addCircle(i,startX,startY,a4)elseif selectedTool=="Rectangle"and firstClick then setNextStrokeColor(i,1,1,1,1)setNextStrokeWidth(i,1)addBox(i,startX,startY,ae-startX,af-startY)end end end;function floodFill(h,g,ag,ah)local T=math.floor(h/p)+1;local U=math.floor(g/p)+1;if T<1 or T>n or U<1 or U>o then return end;if grid[U][T].char~=ag.char or grid[U][T].char==ah.char then return end;grid[U][T]=ah;floodFill(h-p,g,ag,ah)floodFill(h+p,g,ag,ah)floodFill(h,g-p,ag,ah)floodFill(h,g+p,ag,ah)end;function placeElement(h,g)local T=math.floor(h/p)+1;local U=math.floor(g/p)+1;if T>=1 and T<=n and U>=1 and U<=o then if selectedTool=="Pen"then grid[U][T]=selectedElement elseif selectedTool=="Paintbrush"then for d=-1,1 do for ai=-1,1 do if U+d>=1 and U+d<=o and T+ai>=1 and T+ai<=n then grid[U+d][T+ai]=selectedElement end end end elseif selectedTool=="Line"and firstClick then drawLine(math.floor(startX),math.floor(startY),math.floor(h),math.floor(g),selectedElement)firstClick=false elseif selectedTool=="Circle"and firstClick then drawCircle(startX,startY,math.sqrt((h-startX)^2+(g-startY)^2),selectedElement)firstClick=false elseif selectedTool=="Rectangle"and firstClick then drawRectangle(startX,startY,h,g,selectedElement)firstClick=false elseif selectedTool=="Fill"then floodFill(h,g,grid[U][T],selectedElement)end;if debug then logMessage("Placed "..selectedElement.char.." at ("..T..", "..U..")")end end;drawRCostBar(i)end;function loadMapFromText(aj)local ak={}for al in aj:gmatch("[^\n]+")do table.insert(ak,al)end;for g=1,#ak do local al=ak[g]for h=1,#al do local am=al:sub(h,h)if am=="."then grid[g][h]=q.None elseif am=="O"then grid[g][h]=q.Stone elseif am=="W"then grid[g][h]=q.Water elseif am=="F"then grid[g][h]=q.Fire elseif am=="S"then grid[g][h]=q.Sand elseif am=="D"then grid[g][h]=q.Wood elseif am=="P"then grid[g][h]=q.Plant elseif am=="w"then grid[g][h]=q.Wsrc elseif am=="s"then grid[g][h]=q.Ssrc elseif am=="d"then grid[g][h]=q.burning_Wood elseif am=="p"then grid[g][h]=q.burning_Plant elseif am=="C"then grid[g][h]=q.Coal elseif am=="G"then grid[g][h]=q.TNT elseif am=="g"then grid[g][h]=q.ignited_TNT elseif am=="I"then grid[g][h]=q.Ice elseif am=="T"then grid[g][h]=q.Dirt elseif am=="M"then grid[g][h]=q.Mud elseif am=="B"then grid[g][h]=q.Plastic elseif am=="b"then grid[g][h]=q.burning_Plastic elseif am=="m"then grid[g][h]=q.MoltenPlastic end end end end;function loadMap(an)if savedMaps[an]then loadMapFromText(savedMaps[an])else logMessage("No map found with the name "..an)end end;function drawUI()local function w()setNextStrokeColor(i,0,0,0,1)setNextStrokeWidth(i,1)setNextFillColor(i,1,1,1,1)end;local ao=20;local ap=100;setNextFillColor(i,0.1,0.1,0.1,1)addBox(i,0,m-ap,l,ap)local aq=l/#r;for d,ar in ipairs(r)do local E=q[ar]if E.char==selectedElement.char then setNextStrokeColor(i,1,0,0,1)setNextStrokeWidth(i,2)addLine(i,(d-1)*aq,m-ao,(d-1)*aq+aq,m-ao)setNextFillColor(i,unpack(E.color))else setNextFillColor(i,unpack(E.color))end;addBox(i,(d-1)*aq,m-ao,aq,ao)w()addText(i,a,ar,(d-1)*aq+10,m-ao/2+5)end;local as={"Tools","Canvas","B.G","Samples"}local at={["Tools"]={0.8,0.2,0.2,1},["Canvas"]={0.2,0.8,0.2,1},["B.G"]={0.2,0.2,0.8,1},["Samples"]={0.8,0.8,0.2,1}}for d,au in ipairs(as)do setNextFillColor(i,unpack(at[au]))addBox(i,(d-1)*100,m-ap+10,90,20)w()addText(i,a,au,(d-1)*100,m-ap+25)if selectedTab==au then setNextFillColor(i,unpack(at[au]))addBox(i,0,m-ap+30,l,50)if au=="Tools"then local av=l/#b;for ai,aw in ipairs(b)do if aw==selectedTool then setNextFillColor(i,0.3,0.3,0.3,1)else setNextFillColor(i,0.7,0.7,0.7,1)end;addBox(i,(ai-1)*av+2,m-ap+32,av-4,20)if aw==selectedTool then setNextStrokeColor(i,1,0,0,1)setNextStrokeWidth(i,2)addLine(i,(ai-1)*av,m-ap+30,(ai-1)*av+av,m-ap+30)end;w()setNextTextAlign(i,AlignH_Center,AlignV_Baseline)addText(i,a,aw,(ai-1)*av+100,m-ap+47)if fillMode then setNextFillColor(i,0.3,0.3,0.3,1)end;if not fillMode then setNextFillColor(i,0.7,0.7,0.7,1)end;local ax=m-ap+55+2;addBox(i,3*av+2,ax,av-4,20)setNextStrokeColor(i,0.3,0.3,0.3,1)setNextStrokeWidth(i,3)setNextFillColor(i,0.7,0.7,0.7,0)addCircle(i,3*av+15,ax+10,6)setNextStrokeColor(i,0.7,0.7,0.7,1)setNextStrokeWidth(i,3)setNextFillColor(i,0.7,0.7,0.7,1)addCircle(i,3*av+av-15,ax+10,6)setNextStrokeColor(i,0.3,0.3,0.3,1)setNextStrokeWidth(i,3)setNextFillColor(i,0.7,0.7,0.7,0)addBox(i,3*av+30,ax+4,12,12)setNextStrokeColor(i,0.7,0.7,0.7,1)setNextStrokeWidth(i,3)setNextFillColor(i,0.7,0.7,0.7,1)addBox(i,3*av+av-45,ax+4,12,12)w()setNextTextAlign(i,AlignH_Center,AlignV_Baseline)addText(i,a,"Shape Fill",3*av+av/2,ax+15)if paintbucket then setNextFillColor(i,0.3,0.3,0.3,1)end;if not paintbucket then setNextFillColor(i,0.7,0.7,0.7,1)end;local ax=m-ap+55+2;addBox(i,2*av+2,ax,av-4,20)w()setNextTextAlign(i,AlignH_Center,AlignV_Baseline)addText(i,a,"Paintbucket",2*av+av/2,ax+15)end end end end;if selectedTab=="B.G"then local ay=35;local az=l/2-ay/2-60;local aA=m-110;local function aB(h,g,aC,aD,aE,aF)setNextFillColor(i,0.7,0.7,0.7,1)addBox(i,h,g,aC,aD)local aG=h+aE*aC;setNextFillColor(i,0.3,0.3,0.3,1)addBox(i,aG-5,g-5,10,aD+10)setNextFillColor(i,0,0,0,1)addText(i,a,aF,h+aC/2,g+aD+15)end;local function aH(h,g,aC,aD,aE)if getCursorDown(0)then local aI,aJ=getCursor()if aI>=h and aI<=h+aC and aJ>=g and aJ<=g+aD then aE=(aI-h)/aC end end;return aE end;local aK=100;local aL=20;local aM=aA+ay+10;local aN=20;local aO=3*aK+2*aN;local aP=l/2-aO/2;bgColor.r=aH(aP,aM,aK,aL,bgColor.r)aB(aP,aM,aK,aL,bgColor.r,"R")aP=aP+aK+aN;bgColor.g=aH(aP,aM,aK,aL,bgColor.g)aB(aP,aM,aK,aL,bgColor.g,"G")aP=aP+aK+aN;bgColor.b=aH(aP,aM,aK,aL,bgColor.b)aB(aP,aM,aK,aL,bgColor.b,"B")end;if selectedTab=="Samples"then local aQ=80;local aR={"Image 1","Image 2","Image 3","Image 4","Image 5"}for ai,aF in ipairs(aR)do local aS=(ai-1)*(aQ+10)+10;setNextFillColor(i,0.7,0.7,0.7,1)addBox(i,aS,m-ap+40,aQ,20)w()setNextTextAlign(i,AlignH_Center,AlignV_Baseline)addText(i,a,aF,aS+aQ/2,m-ap+55)end end;if selectedTab=="Canvas"then local aT={undo={isUndoing,{0.7,0.7,0.7,1},{0.3,0.3,0.3,1},"Undo","Undoing"},redo={isRedoing,{0.7,0.7,0.7,1},{0.3,0.3,0.3,1},"Redo","Redoing"},save={isSaving,{0.7,0.7,0.7,1},{0.3,0.3,0.3,1},"Save","Saved"},load={isLoading,{0.7,0.7,0.7,1},{0.3,0.3,0.3,1},"Load","Loaded"},reset={isResetting,{0.7,0.7,0.7,1},{0.3,0.3,0.3,1},"Reset","Resetting"},chatsave={chatSaving,{0.7,0.7,0.7,1},{0.3,0.3,0.3,1},"ChatSave","Sent"},chatload={chatLoading,{0.7,0.7,0.7,1},{0.3,0.3,0.3,1},"ChatLoad","Checking"}}local aU={"Undo","Redo","Save","Load","Reset","ChatSave","ChatLoad"}local aV={10,110,210,310,410,510,610}for d,aF in ipairs(aU)do local H=aT[aF:lower()]local aW=H[1]local aX=H[2]local aY=H[3]local aZ=H[5]setNextFillColor(i,unpack(aW and aY or not aW and aX))addBox(i,aV[d],m-60,90,20)w()setNextTextAlign(i,AlignH_Center,AlignV_Baseline)addText(i,a,aW and getTime()-(aF:lower()=="save"and saveMessageTime or loadMessageTime)<2 and aZ or aF,aV[d]+45,m-45)end end;drawRCostBar(i)drawPreview()end;function printGridState()for g=1,o do local a_=""for h=1,n do local E=grid[g][h]a_=a_..E.char end;logMessage(a_)end end;function moveElement(h,g,b0,b1)grid[b1][b0]=grid[g][h]grid[g][h]=q.None;moved=true end;function igniteTNT(g,h)local b2={{g,h}}local b3={}while#b2>0 do local b4=table.remove(b2,1)local a0,_=b4[1],b4[2]b3[a0*n+_]=true;local b5={{a0+1,_},{a0-1,_},{a0,_+1},{a0,_-1},{a0+1,_+1},{a0+1,_-1},{a0-1,_+1},{a0-1,_-1}}for a2,b6 in ipairs(b5)do local b7,b8=unpack(b6)if b7>=1 and b7<=o and b8>=1 and b8<=n then local b9=grid[b7][b8]if b9.char=="G"and not b3[b7*n+b8]then table.insert(b2,{b7,b8})b3[b7*n+b8]=true elseif b9.char~="O"then grid[b7][b8]=q.None end;if b9.char=="D"then grid[b7][b8]=q.burning_Wood elseif b9.char=="P"then grid[b7][b8]=q.burning_Plant elseif b9.char=="G"then grid[b7][b8]=q.ignited_TNT elseif b9.char=="S"then grid[b7][b8]=q.Glass end end end;for P=-tntBlastRange,tntBlastRange do for O=-tntBlastRange,tntBlastRange do local b8,b7=_+O,a0+P;if b8>=1 and b8<=n and b7>=1 and b7<=o then local b9=grid[b7][b8]local ba=math.sqrt(O*O+P*P)if ba<=tntBlastRange then if b9.char=="S"then grid[b7][b8]=q.Glass elseif b9.char=="C"then local bb=b8+math.floor(O/ba)local bc=b7+math.floor(P/ba)if bb>=1 and bb<=n and bc>=1 and bc<=o then grid[b7][b8]=q.None;grid[bc][bb]=b9 end elseif b9.char=="W"then grid[b7][b8]=q.None elseif b9.char=="D"or b9.char=="P"then if ba<=tntBlastRange/2 then grid[b7][b8]=q.burning_Wood else grid[b7][b8]=q.burning_Plant end elseif b9.char=="B"then if ba<=tntBlastRange/2 then grid[b7][b8]=q.MoltenPlastic else grid[b7][b8]=q.burning_Plastic end end end end end end;grid[a0][_]=q.None end end;function simulate()if TNTLastDetonationTime and getTime()-TNTLastDetonationTime>TNTCooldown then TNTDetonationCount=0 end;for g=o-1,1,-1 do for h=1,n do local E=grid[g][h]if E.char=="S"or E.char=="C"then local bd=g<o and grid[g+1][h].char=="."local be=h>1 and grid[g+1][h-1].char=="."local bf=h<n and grid[g+1][h+1].char=="."if bd then moveElement(h,g,h,g+1)elseif be and bf then if alternateDirection then moveElement(h,g,h-1,g+1)else moveElement(h,g,h+1,g+1)end;alternateDirection=not alternateDirection elseif be then moveElement(h,g,h-1,g+1)elseif bf then moveElement(h,g,h+1,g+1)end elseif E.char=="wS"then if g<o and grid[g+1][h].char=="."then grid[g+1][h]=q.Water;moved=true end elseif E.char=="sS"then if g<o and grid[g+1][h].char=="."then grid[g+1][h]=q.Sand;moved=true end elseif E.char=="W"then local bd=g<o and grid[g+1][h].char=="."local be=h>1 and grid[g][h-1].char=="."local bf=h<n and grid[g][h+1].char=="."local bg=g<o and h>1 and grid[g+1][h-1].char=="."local bh=g<o and h<n and grid[g+1][h+1].char=="."if bd then moveElement(h,g,h,g+1)grid[g+1][h].direction=E.direction elseif be and bf then if E.direction==0 then E.direction=alternateDirection and-1 or 1;alternateDirection=not alternateDirection end;if E.direction==-1 then moveElement(h,g,h-1,g)grid[g][h-1].direction=E.direction else moveElement(h,g,h+1,g)grid[g][h+1].direction=E.direction end elseif be then moveElement(h,g,h-1,g)grid[g][h-1].direction=-1 elseif bf then moveElement(h,g,h+1,g)grid[g][h+1].direction=1 elseif bg then moveElement(h,g,h-1,g+1)grid[g+1][h-1].direction=-1 elseif bh then moveElement(h,g,h+1,g+1)grid[g+1][h+1].direction=1 end elseif E.char=="B"then local b5={{g+1,h},{g-1,h},{g,h+1},{g,h-1}}for a2,b6 in ipairs(b5)do local b7,b8=unpack(b6)if b7>=1 and b7<=o and b8>=1 and b8<=n then local b9=grid[b7][b8]if b9.char=="F"then grid[g][h]=q.burning_Plastic;grid[g][h].burnCount=0;moved=true end end end elseif E.char=="b"then E.burnCount=E.burnCount+1;if E.burnCount>=5 then grid[g][h]=q.MoltenPlastic;grid[g][h].coolingCount=0;moved=true else local b5={{g+1,h},{g-1,h},{g,h+1},{g,h-1}}for a2,b6 in ipairs(b5)do local b7,b8=unpack(b6)if b7>=1 and b7<=o and b8>=1 and b8<=n then local b9=grid[b7][b8]if b9.char=="D"then grid[b7][b8]=q.burning_Wood;grid[b7][b8].fuelCount=0;moved=true elseif b9.char=="P"then grid[b7][b8]=q.burning_Plant;grid[b7][b8].fuelCount=0;moved=true elseif b9.char=="B"then grid[b7][b8]=q.burning_Plastic;grid[b7][b8].burnCount=0;moved=true end end end end elseif E.char=="m"then E.coolingCount=E.coolingCount+1;if E.coolingCount>=10 then grid[g][h]=q.Plastic;moved=true else local bd=g<o and grid[g+1][h].char=="."local be=h>1 and grid[g+1][h-1].char=="."local bf=h<n and grid[g+1][h+1].char=="."if bd then moveElement(h,g,h,g+1)grid[g+1][h].coolingCount=E.coolingCount elseif be and bf then if alternateDirection then moveElement(h,g,h-1,g+1)grid[g+1][h-1].coolingCount=E.coolingCount else moveElement(h,g,h+1,g+1)grid[g+1][h+1].coolingCount=E.coolingCount end;alternateDirection=not alternateDirection elseif be then moveElement(h,g,h-1,g+1)grid[g+1][h-1].coolingCount=E.coolingCount elseif bf then moveElement(h,g,h+1,g+1)grid[g+1][h+1].coolingCount=E.coolingCount end end elseif E.char=="S"then local b5={{g+1,h},{g-1,h},{g,h+1},{g,h-1}}for a2,b6 in ipairs(b5)do local b7,b8=unpack(b6)if b7>=1 and b7<=o and b8>=1 and b8<=n then local b9=grid[b7][b8]if b9.char=="F"then grid[g][h]=q.BurningSand;grid[g][h].burnCount=0;moved=true end end end elseif E.char=="BS"then E.burnCount=E.burnCount+1;if E.burnCount>=10 then grid[g][h]=q.Glass;moved=true end elseif E.char=="GS"then local b5={{g+1,h},{g-1,h},{g,h+1},{g,h-1}}for a2,b6 in ipairs(b5)do local b7,b8=unpack(b6)if b7>=1 and b7<=o and b8>=1 and b8<=n then local b9=grid[b7][b8]if b9.char=="p"or b9.char=="b"or b9.char=="d"then if TNTDetonationCount<TNTDetonationLimit or getTime()-TNTLastDetonationTime>TNTCooldown then TNTDetonationCount=TNTDetonationCount+1;igniteTNT(g,h)TNTLastDetonationTime=getTime()end;grid[g][h].burnCount=0;moved=true end end end elseif E.char=="T"then local b5={{g+1,h},{g-1,h},{g,h+1},{g,h-1}}for a2,b6 in ipairs(b5)do local b7,b8=unpack(b6)if b7>=1 and b7<=o and b8>=1 and b8<=n then local b9=grid[b7][b8]if b9.char=="W"then grid[g][h]=q.Mud;grid[b7][b8]=q.None;moved=true;break end end end elseif E.char=="M"then local b5={{g+1,h},{g-1,h},{g,h+1},{g,h-1}}for a2,b6 in ipairs(b5)do local b7,b8=unpack(b6)if b7>=1 and b7<=o and b8>=1 and b8<=n then local b9=grid[b7][b8]if b9.char=="F"then grid[g][h]=q.Dirt;moved=true;break end end end elseif E.char=="F"then local bi=g*n+h;fireSpreadCounter[bi]=(fireSpreadCounter[bi]or 0)+1;if fireSpreadCounter[bi]>=fireSpreadDelay then fireSpreadCounter[bi]=0;local b5={{g+1,h},{g-1,h},{g,h+1},{g,h-1}}local bj=false;for a2,b6 in ipairs(b5)do local b7,b8=unpack(b6)if b7>=1 and b7<=o and b8>=1 and b8<=n then local b9=grid[b7][b8]if b9.char=="W"then grid[g][h]=q.None;moved=true elseif b9.char=="D"then grid[b7][b8]=q.burning_Wood;grid[b7][b8].fuelCount=0;moved=true;bj=true elseif b9.char=="P"then grid[b7][b8]=q.burning_Plant;grid[b7][b8].fuelCount=0;moved=true;bj=true elseif b9.char=="B"then grid[b7][b8]=q.burning_Plastic;grid[b7][b8].burnCount=0;moved=true;bj=true elseif b9.char=="G"then igniteTNT(b7,b8)moved=true;bj=true end end end;if not bj then grid[g][h].fuelCount=(grid[g][h].fuelCount or 0)+1;if grid[g][h].fuelCount>=fireSpreadDelay*2 then grid[g][h]=q.None;moved=true end end end elseif E.char=="d"or E.char=="p"then local bi=g*n+h;fireSpreadCounter[bi]=fireSpreadCounter[bi]+1;if fireSpreadCounter[bi]>=fireSpreadDelay then local b5={{g+1,h},{g-1,h},{g,h+1},{g,h-1}}for a2,b6 in ipairs(b5)do local b7,b8=unpack(b6)if b7>=1 and b7<=o and b8>=1 and b8<=n then local b9=grid[b7][b8]if b9.char=="W"then grid[g][h]=q.None;moved=true elseif b9.char=="D"then grid[b7][b8]=q.burning_Wood;moved=true elseif b9.char=="P"then grid[b7][b8]=q.burning_Plant;moved=true elseif b9.char=="G"then igniteTNT(b7,b8)moved=true end end end end;if fireSpreadCounter[bi]>=fireSpreadDelay*2 then grid[g][h]=q.Coal;fireSpreadCounter[bi]=0;moved=true end elseif E.char=="g"then local b5={{g+1,h},{g-1,h},{g,h+1},{g,h-1},{g+1,h+1},{g+1,h-1},{g-1,h+1},{g-1,h-1}}for a2,b6 in ipairs(b5)do local b7,b8=unpack(b6)if b7>=1 and b7<=o and b8>=1 and b8<=n then local b9=grid[b7][b8]if b9.char~="O"then grid[b7][b8]=q.None end;if b9.char=="D"then grid[b7][b8]=q.burning_Wood elseif b9.char=="P"then grid[b7][b8]=q.burning_Plant elseif b9.char=="G"then grid[b7][b8]=q.ignited_TNT elseif b9.char=="S"then grid[b7][b8]=q.Glass end end end;for P=-tntBlastRange,tntBlastRange do for O=-tntBlastRange,tntBlastRange do local b8,b7=h+O,g+P;if b8>=1 and b8<=n and b7>=1 and b7<=o then local b9=grid[b7][b8]local ba=math.sqrt(O*O+P*P)if ba<=tntBlastRange then if b9.char=="S"then grid[b7][b8]=q.Glass elseif b9.char=="C"then local bb=b8+math.floor(O/ba)local bc=b7+math.floor(P/ba)if bb>=1 and bb<=n and bc>=1 and bc<=o then grid[b7][b8]=q.None;grid[bc][bb]=b9 end elseif b9.char=="W"then grid[b7][b8]=q.None elseif b9.char=="D"or b9.char=="P"then if ba<=tntBlastRange/2 then grid[b7][b8]=q.burning_Wood else grid[b7][b8]=q.burning_Plant end elseif b9.char=="B"then if ba<=tntBlastRange/2 then grid[b7][b8]=q.MoltenPlastic else grid[b7][b8]=q.burning_Plastic end end end end end end;grid[g][h]=q.None end end end;if moved then if debug then logMessage("Simulation step: elements moved")end else if debug then logMessage("Simulation step: no movement")end end end;function handleMouse()local ae,af=getCursor()local T=math.floor(ae/p)+1;local U=math.floor(af/p)+1;s(k,ae,af)if af>m-100 and getCursorDown()then startX,startY=nil,nil;firstClick=false end;if af<m-100 then if getCursorDown()then if selectedTool=="Line"or selectedTool=="Circle"or selectedTool=="Rectangle"and not paintbucket then if firstClick then G()placeElement(ae,af)else firstClick=true;startX,startY=ae,af end elseif selectedTool=="Pen"and not paintbucket then G()placeElement(ae,af)elseif selectedTool=="Paintbrush"and not paintbucket then G()placeElement(ae,af,4)end end elseif ae>=0 and ae<=90 and af>=m-100 and af<=m-80 then if getCursorDown()then selectedTab="Tools"end elseif ae>=100 and ae<=190 and af>=m-100 and af<=m-80 then if getCursorDown()then selectedTab="Canvas"end elseif ae>=200 and ae<=290 and af>=m-100 and af<=m-80 then if getCursorDown()then selectedTab="B.G"end elseif ae>=300 and ae<=390 and af>=m-100 and af<=m-80 then if getCursorDown()then selectedTab="Samples"end elseif af>=m-20 then if getCursorDown()then local aq=l/#r;local bk=math.floor(ae/aq)+1;selectedElement=q[r[bk]]end elseif selectedTab=="Tools"then if af>=560 and af<=585 and ae>=420 and ae>=620 and getCursorPressed()then fillMode=not fillMode elseif af>=560 and af<=585 and ae>=220 and ae>=400 and getCursorPressed()then paintbucket=not paintbucket end;if af>=m-70 and af<=m-50 then local av=l/#b;local bl=math.floor(ae/av)+1;if bl>=1 and bl<=#b then if getCursorDown()then selectedTool=b[bl]end end end elseif selectedTab=="Canvas"then if af>=m-60 and af<=m-40 then if ae>=10 and ae<=100 then if getCursorDown()then isUndoing=true;I()end elseif ae>=110 and ae<=200 then if getCursorDown()then isRedoing=true;J()end elseif ae>=210 and ae<=300 then if getCursorDown()then isSaving=true;saveMessageTime=getTime()saveState()end elseif ae>=310 and ae<=400 then if getCursorDown()then isLoading=true;loadMessageTime=getTime()loadState()end elseif ae>410 and ae<=500 then if getCursorDown()then isResetting=true;F()end elseif ae>510 and ae<=600 then if getCursorDown()then chatSave=true;printGridState()end elseif ae>610 and ae<=700 then if getCursorDown()then chatLoad=true end end end elseif selectedTab=="Samples"then local aQ=80;local bm=10;local bn=m-60;if af>=bn and af<=bn+20 then if ae>=bm and ae<=bm+aQ then if getCursorDown()then F()loadMapFromText(Image1)end elseif ae>=bm+90 and ae<=bm+90+aQ then if getCursorDown()then F()loadMapFromText(Image2)end elseif ae>=bm+180 and ae<=bm+180+aQ then if getCursorDown()then F()loadMapFromText(Image3)end elseif ae>=bm+270 and ae<=bm+270+aQ then if getCursorDown()then F()loadMapFromText(Image4)end elseif ae>=bm+360 and ae<=bm+360+aQ then if getCursorDown()then F()loadMapFromText(Image5)end end end end;if paintbucket and T>=1 and T<=n and U>=1 and U<=o and getCursorDown()then local ag=grid[U][T]if ag and ag.char~=selectedElement.char then G()floodFill(ae,af,ag,selectedElement)paintbucket=false end end end;function update()if not first then G()first=true end;q.None.color={bgColor.r,bgColor.g,bgColor.b,1}local bo=getTime()if bo-lastTime>0.1 then simulate()lastTime=bo end;handleMouse()drawGrid()drawUI()requestAnimationFrame(1)end;update()
